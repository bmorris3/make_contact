{% extends "base.html" %}

{% block title %}Science Policy Form{% endblock %}

{% block content %}

<div class="container">
    <h1 class="center">Science Policy Form</h1>
    <p class="center">
        <a href="/faq">Frequently Asked Questions</a>
    </p>
    <br>

    {% if suggestions %}
        <h5>Here are some suggestions on your writing:</h5>
        <p id="proof_read">
            {{suggestions | safe}}
        </p>

        <p>Edit your message with the suggestions above, and click Submit again.</p>
    {% endif %}

    <form action="/" method="POST">
    {% for field in form %}
        <div class="row">
            <div class="four columns textright">
                <span class="form-label">{{ field.label }}:</span>
            </div>
            {% if field.type == 'RadioField' %}
                <div class="eight columns">
                {% for subfield in field %}
                    <span class="radio">{{ subfield() }}&nbsp;&nbsp;{{ subfield.label }}</span>
                {% endfor %}
            {% else %}
                <div class="seven columns"> {{ field() }}
            {% endif %}
            {% if field.errors %}
                <p class="error">
                {% for error in field.errors %}
                    {{ error }}{% if not loop.last %}<br>{% endif %}
                {% endfor %}
                </p>
            {% endif %}
            </div>
        </div>
    {% endfor %}
    <center><input class="button button-primary" type="submit" value="Submit"></center>
    </form>

{% if signature %}

    <h4>Click the names below to see the call scripts and emails</h4>
    <ul class="tab">
    {% for rep in list_of_reps %}
        <li><a href="javascript:void(0)" class="tablinks" onclick="openRep(event, '{{rep.name}}')">{{rep.title[:3]}}. {{rep.name}}</a></li>
    {% endfor %}
    </ul>

    {% for rep in list_of_reps %}

    <section id="{{rep.name}}" class="tabcontent u-cf">

    <div id="phone" class="six columns">
        <h5>Call Script</h5>
        <p>Call {{rep.title}} {{rep.name}} at {{rep.phone}}.</p>
        <p>Calling your representativeâ€™s office is an effective way of making your voice heard
            on a topic that requires only a short explanation. Please note that the staffer
            answering your call may not be able to answer your specific question or make a
            policy statement. If so, ask them to please take a message to the representative
            on your behalf. Please be polite, respectful, and concise. You can do this! </p>
        <textarea class="letter" rows="12" type="text" name="phone">
My name is {{form.data.name}}. I'm calling {{rep.title}} {{rep.name}} to {{form.data.stance}} your stance on {{form.data.subject}}.

{{form.data.body}}
        </textarea>
    </div>

    <div id="email" class="six columns">
        <h5>Email</h5>
        <p>Cut and paste this text into the contact form for <a href={{rep.url}}>{{rep.title}} {{rep.name}}</a>.</p>
        <textarea class="letter" rows="20" type="text" name="letter">
The Honorable {{rep.letter_address()}}

Dear {{rep.title}} {{rep.name}},

My name is {{form.data.name}}, and I {{form.data.stance}} your stance on {{form.data.subject}}.

{{form.data.body}}

{{signature}}
        </textarea>
    </div>


    </section>
    {% endfor %}

    <br><br>
    <p>
        <a href="/">Click here to start over.</a>
    </p>
    </div>

{% endif %}

</div>

<script type="text/javascript">
function openRep(evt, repName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the link that opened the tab
    document.getElementById(repName).style.display = "block";
    evt.currentTarget.className += " active";
}
</script>


{% endblock %}